(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[221],{1783:(e,t,a)=>{Promise.resolve().then(a.bind(a,5804))},5267:()=>{},5804:(e,t,a)=>{"use strict";a.d(t,{default:()=>w});var r=a(5155),s=a(2115),i=a(5695),l=a(6766),n=a(6874),o=a.n(n),c=a(4416),d=a(4481),u=a(6262),m=a(133),g=a(1802);let h=e=>{let{show:t,onHide:a,uploadedImage:i,maskImage:l,onSave:n}=e,[o,h]=(0,s.useState)({x:0,y:0}),[p,x]=(0,s.useState)(1),[f,v]=(0,s.useState)(!1),[b,y]=(0,s.useState)({x:0,y:0}),[w,j]=(0,s.useState)(!1),[N,I]=(0,s.useState)({width:0,height:0}),[S,k]=(0,s.useState)(!1),F=(0,s.useRef)(null),C=(0,s.useRef)(null),z=(0,s.useRef)(null),P=(0,s.useRef)(null),B={maxSizeMB:2,maxWidthOrHeight:2400,useWebWorker:!0,fileType:"image/png",initialQuality:.95},E=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a]},U=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a]},M=()=>{if(!C.current||!F.current||S)return;let e=C.current.getBoundingClientRect(),t=F.current.getBoundingClientRect(),a=(t.width-e.width)/2,r=(t.height-e.height)/2;h({x:a,y:r}),k(!0),E("Image centered at:",{x:a,y:r})},O=async e=>{try{let t=e.split(",")[1],a=e.split(",")[0].split(":")[1].split(";")[0],r=atob(t),s=Array(r.length);for(let e=0;e<r.length;e++)s[e]=r.charCodeAt(e);let i=new Uint8Array(s),l=new Blob([i],{type:a});E("Original size: ".concat((l.size/1024/1024).toFixed(2),"MB"));let n=await (0,g.A)(l,B);return E("Compressed size: ".concat((n.size/1024/1024).toFixed(2),"MB")),new Promise(e=>{let t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL(n)})}catch(t){return U("Compression failed:",t),e}};(0,s.useEffect)(()=>{if(!t||!l||!F.current)return;E("Setting up mask...");let e=new Image;e.onload=()=>{if(!F.current)return void U("Container ref lost during image load");let t=e.naturalWidth/e.naturalHeight;E("Aspect ratio:",t),F.current.style.aspectRatio="".concat(t),I({width:e.naturalWidth,height:e.naturalHeight})},e.src=l},[t,l]),(0,s.useEffect)(()=>{t&&i&&(k(!1),setTimeout(()=>{M()},100))},[t,i]);let R=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!w){if(e=Math.max(.1,Math.min(5,e)),null!==t&&null!==a){let r=e/p;h({x:o.x-t*(r-1),y:o.y-a*(r-1)})}else{if(!C.current)return;let t=C.current.getBoundingClientRect(),a=t.width/2,r=t.height/2,s=e/p;h({x:o.x-a*(s-1),y:o.y-r*(s-1)})}x(e)}},A=e=>{if(w||(e.cancelable&&e.preventDefault(),!C.current||!F.current))return;let t=C.current.getBoundingClientRect(),a=e.clientX-t.left,r=e.clientY-t.top;R(p+.025*Math.sign(-e.deltaY),a,r)},D=()=>{v(!1),F.current&&(F.current.style.cursor=w?"not-allowed":"grab")},L=async()=>{if(!i||!l||!C.current||!z.current)return void U("Missing required elements for saving");j(!0),F.current&&(F.current.style.cursor="not-allowed"),E("Starting save process...");try{let e=P.current;if(!e)throw Error("Canvas not found");let t=e.getContext("2d",{willReadFrequently:!0});if(!t)throw Error("Canvas context not found");let[r,s]=await Promise.all([new Promise((e,t)=>{let a=new Image;a.onload=()=>e(a),a.onerror=t,a.src=i}),new Promise((e,t)=>{let a=new Image;a.onload=()=>e(a),a.onerror=t,a.src=l})]),c=z.current.getBoundingClientRect();e.width=s.naturalWidth,e.height=s.naturalHeight,t.clearRect(0,0,e.width,e.height);let d=s.naturalWidth/c.width,u=s.naturalHeight/c.height,m=C.current.width*p*d,g=C.current.height*p*u,h=o.x*d,x=o.y*u;t.save(),t.beginPath(),t.rect(0,0,s.naturalWidth,s.naturalHeight),t.clip(),t.drawImage(r,h,x,m,g),t.restore(),((e,t)=>{E("Converting to grayscale...");let a=e.getImageData(0,0,t.width,t.height),r=a.data;for(let e=0;e<r.length;e+=4){let t=r[e],a=r[e+1],s=Math.round(.299*t+.587*a+.114*r[e+2]);r[e]=s,r[e+1]=s,r[e+2]=s}e.putImageData(a,0,0),E("Grayscale conversion complete")})(t,e),t.drawImage(s,0,0);let f=e.toDataURL("image/png",1);if("data:,"===f)throw Error("Generated data URL is invalid");E("Compressing final image...");let v=await O(f);E("Save complete!"),n(v),a()}catch(e){U("Error saving image:",e)}finally{j(!1),F.current&&(F.current.style.cursor="grab")}};return((0,s.useEffect)(()=>{let e=F.current;if(e)return e.addEventListener("wheel",A,{passive:!1}),()=>e.removeEventListener("wheel",A)},[p,o,w]),(0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t&&!w&&a()};if(t)return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,w,a]),(0,s.useEffect)(()=>{F.current&&(F.current.style.cursor=w?"not-allowed":"grab")},[w]),t)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/70 z-[1040] transition-opacity",onClick:w?void 0:a}),(0,r.jsx)("div",{className:"fixed inset-0 z-[1050] flex items-center justify-center p-4 overflow-y-auto",children:(0,r.jsx)("div",{className:"image-editor-modal relative w-full max-w-[90vw] mx-auto my-8",onClick:e=>e.stopPropagation(),children:(0,r.jsxs)("div",{className:"bg-[var(--surface-900)] rounded-lg shadow-xl w-fit mx-auto max-w-[90vw]",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between border-b border-[var(--surface-700)] px-6 py-4",children:[(0,r.jsx)("h3",{className:"text-[var(--surface-50)] text-xl font-medium",children:"Edit Image"}),(0,r.jsx)("button",{onClick:a,disabled:w,className:"text-gray-400 hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:(0,r.jsx)(c.A,{size:24})})]}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{ref:F,className:"editor-workspace ".concat(w?"pointer-events-none opacity-75":""),onMouseDown:e=>{!w&&(e.preventDefault(),v(!0),y({x:e.clientX-o.x,y:e.clientY-o.y}),F.current&&(F.current.style.cursor="grabbing"))},onMouseMove:e=>{if(f&&!w)h({x:e.clientX-b.x,y:e.clientY-b.y})},onMouseUp:D,onMouseLeave:D,children:[(0,r.jsxs)("div",{className:"editor-zoom-controls",children:[(0,r.jsx)("button",{onClick:()=>R(1.1*p),title:"Zoom In",disabled:w,className:"w-10 h-10 flex items-center justify-center bg-[var(--surface-700)] border border-[var(--surface-600)] text-[var(--surface-50)] rounded hover:bg-[var(--surface-600)] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:(0,r.jsx)(d.A,{size:18})}),(0,r.jsxs)("div",{className:"zoom-value text-center text-[var(--surface-200)] text-sm py-1",children:[Math.round(100*p),"%"]}),(0,r.jsx)("button",{onClick:()=>R(.9*p),title:"Zoom Out",disabled:w,className:"w-10 h-10 flex items-center justify-center bg-[var(--surface-700)] border border-[var(--surface-600)] text-[var(--surface-50)] rounded hover:bg-[var(--surface-600)] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:(0,r.jsx)(u.A,{size:18})})]}),(0,r.jsx)("img",{ref:C,src:i||"",alt:"Upload",className:"uploaded-image",onLoad:M,style:{transform:"translate(".concat(o.x,"px, ").concat(o.y,"px) scale(").concat(p,")"),transformOrigin:"0 0",pointerEvents:w?"none":"auto"}}),l&&(0,r.jsx)("img",{ref:z,src:l,alt:"Mask",className:"mask-image",onLoad:()=>E("Mask loaded"),onError:e=>U("Mask failed:",e)}),w&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center z-20 rounded-lg",children:(0,r.jsxs)("div",{className:"text-center text-white",children:[(0,r.jsx)("div",{className:"inline-block w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin mb-2",role:"status",children:(0,r.jsx)("span",{className:"sr-only",children:"Processing..."})}),(0,r.jsx)("div",{className:"font-semibold",children:"Converting to Black & White..."}),(0,r.jsx)("div",{className:"text-sm text-gray-300 mt-1",children:"Compressing and saving..."})]})}),(0,r.jsx)("canvas",{ref:P,style:{display:"none"}})]})}),(0,r.jsxs)("div",{className:"modal-footer border-t border-[var(--surface-700)] px-6 py-4 flex justify-between gap-4",children:[(0,r.jsx)("div",{className:"modal-footer-group flex gap-3",children:(0,r.jsxs)("button",{className:"btn-reset flex items-center gap-2 text-[var(--surface-400)] hover:text-[var(--surface-200)] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>{w||(x(1),k(!1),setTimeout(()=>{M()},50),E("Reset position and scale"))},title:"Reset Image Position",disabled:w,children:[(0,r.jsx)(m.A,{size:18}),(0,r.jsx)("span",{children:"Reset"})]})}),(0,r.jsxs)("div",{className:"modal-footer-group flex gap-3",children:[(0,r.jsx)("button",{className:"btn btn-secondary px-6 py-2 rounded-lg disabled:cursor-not-allowed",onClick:a,disabled:w,children:"Cancel"}),(0,r.jsx)("button",{className:"btn btn-primary px-6 py-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",onClick:L,disabled:w,children:w?(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"cursor-pointer inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin",role:"status","aria-hidden":"true"}),"Processing..."]}):"Save Changes"})]})]})]})})})]}):null};var p=a(9723);async function x(e){return new Promise((t,a)=>{let r=new Image;r.onload=()=>{let e=document.createElement("canvas"),a=r.width,s=r.height;a>s?a>100&&(s=100*s/a,a=100):s>100&&(a=100*a/s,s=100),e.width=a,e.height=s,e.getContext("2d").drawImage(r,0,0,a,s),t(e.toDataURL("image/jpeg",.5))},r.onerror=()=>a(Error("Image compression failed")),r.src=e})}async function f(e){var t,a,r,s;p.vF.order("Adding item to cart",{hasCustomImage:!!e.customImage,originalImageSize:(null==(a=e.customImage)||null==(t=a.dataUrl)?void 0:t.length)||0});try{let t=b();if(!t.isHealthy)throw Error(t.message||"Storage quota exceeded. Please clear your cart.");let a=v(),i=null;if(null==(r=e.customImage)?void 0:r.dataUrl){i=e.customImage.dataUrl;let t="".concat(e.productId,"_").concat(Date.now());y(t,i)}let l=e.customImage;if(null==(s=e.customImage)?void 0:s.dataUrl)try{let t=await x(e.customImage.dataUrl);l={...e.customImage,dataUrl:t,fullResId:i?"".concat(e.productId,"_").concat(Date.now()):void 0},p.vF.info("Image compressed",{original:e.customImage.dataUrl.length,compressed:t.length,reduction:((1-t.length/e.customImage.dataUrl.length)*100).toFixed(1)+"%"})}catch(e){p.vF.error("Image compression failed, skipping image",e),l=void 0}let n=function(e){if(!e)return{};let t={...e};return delete t.rawImageUrl,delete t.imageUrl,delete t.maskedImageUrl,{size:t.size,background:t.background,lightBase:t.lightBase,giftStand:t.giftStand,customText:t.customText,imageFilename:t.imageFilename,maskName:t.maskName}}(e.options),o={productId:e.productId,name:e.name,sku:e.sku,price:e.price||e.totalPrice,quantity:e.quantity,options:n,sizeDetails:e.size||e.sizeDetails,customImage:l,cockpit3d_id:e.cockpit3d_id,dateAdded:e.dateAdded||new Date().toISOString()};a.push(o),function(e){try{let t=JSON.stringify(e),a=(t.length/1024).toFixed(2);if(p.vF.info("Saving cart",{items:e.length,sizeKB:a}),b().percentUsed>85){p.vF.warn("Storage approaching limit, attempting cleanup");let e=function(){try{let e=v(),t=0;JSON.stringify(e).length;let a=e.map((a,r)=>{var s;return r<e.length-3&&(null==(s=a.customImage)?void 0:s.dataUrl)?(t+=a.customImage.dataUrl.length,{...a,customImage:{...a.customImage,dataUrl:""}}):a});return t>0&&(localStorage.setItem("cart",JSON.stringify(a)),p.vF.info("Cleaned up old cart images",{savedBytes:t})),t}catch(e){return p.vF.error("Cleanup failed",e),0}}();e>0&&p.vF.info("Cleaned up ".concat(e," bytes from cart"))}localStorage.setItem("cart",t);let r=new CustomEvent("cartUpdated",{detail:{itemCount:e.length,totalItems:e.reduce((e,t)=>e+t.quantity,0)}});window.dispatchEvent(r)}catch(t){if("QuotaExceededError"===t.name){p.vF.error("Cart storage quota exceeded",{itemCount:e.length,sizeKB:(JSON.stringify(e).length/1024).toFixed(2)});try{let t=e.map(e=>({...e,customImage:e.customImage?{...e.customImage,dataUrl:""}:void 0}));localStorage.setItem("cart",JSON.stringify(t)),p.vF.warn("Cart saved without image thumbnails to prevent quota error"),alert("Cart is full. Images have been removed to save your items. You can still checkout.")}catch(e){throw Error("Cart storage full. Please remove some items or clear cart.")}}else throw p.vF.error("Failed to save cart",t),t}}(a),p.vF.success("Item added to cart",{totalItems:a.length,hasImage:!!o.customImage,cartSizeKB:(JSON.stringify(a).length/1024).toFixed(2)})}catch(e){throw p.vF.error("Failed to add item to cart",e),e}}function v(){try{let e=localStorage.getItem("cart");return e?JSON.parse(e):[]}catch(e){return p.vF.error("Failed to read cart",e),[]}}function b(){try{let e=0;for(let t in localStorage)localStorage.hasOwnProperty(t)&&(e+=localStorage[t].length+t.length);let t=e/5242880*100;if(p.vF.info("Storage health check",{usedBytes:e,usedKB:(e/1024).toFixed(2),usedMB:(e/1024/1024).toFixed(2),percentUsed:t.toFixed(1)+"%"}),t>90)return{isHealthy:!1,usedSpace:e,totalSpace:5242880,percentUsed:t,message:"Storage critically full (>90%). Please clear your cart."};if(t>80)return p.vF.warn("Storage approaching limit",{percentUsed:t.toFixed(1)+"%"}),{isHealthy:!0,usedSpace:e,totalSpace:5242880,percentUsed:t,message:"Storage nearly full (>80%). Consider clearing cart soon."};return{isHealthy:!0,usedSpace:e,totalSpace:5242880,percentUsed:t}}catch(e){return p.vF.error("Storage health check failed",e),{isHealthy:!1,usedSpace:0,totalSpace:0,percentUsed:100,message:"Unable to check storage. Your browser may be blocking localStorage."}}}function y(e,t){try{sessionStorage.setItem("fullimg_".concat(e),t),p.vF.info("Full-res image stored in sessionStorage",{productId:e,sizeKB:(t.length/1024).toFixed(2)})}catch(a){p.vF.warn("Could not store full-res image in sessionStorage",a);try{x(t).then(t=>{sessionStorage.setItem("fullimg_".concat(e),t),p.vF.info("Stored compressed fallback image")})}catch(e){p.vF.error("All image storage methods failed",e)}}}function w(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),[n,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(!0),[m,g]=(0,s.useState)(""),[x,v]=(0,s.useState)(null),[w,j]=(0,s.useState)(null),[N,I]=(0,s.useState)(null),[S,k]=(0,s.useState)(null),[F,C]=(0,s.useState)({line1:"",line2:""}),[z,P]=(0,s.useState)(1),[B,E]=(0,s.useState)(null),[U,M]=(0,s.useState)(""),[O,R]=(0,s.useState)(null),[A,D]=(0,s.useState)(!1),[L,_]=(0,s.useState)(!1),[q,H]=(0,s.useState)(""),[T,G]=(0,s.useState)({});(0,s.useEffect)(()=>{e.slug&&J(e.slug)},[e.slug]);let J=async e=>{try{p.vF.info("Fetching product",{slug:e,envMode:"production"});let{cockpit3dProducts:t}=await a.e(145).then(a.bind(a,1145));p.vF.info("Loaded ".concat(t.length," products from cache"));let r=t.find(t=>t.slug===e);if(!r)throw Error("Product not found");c(r),r.sizes&&r.sizes.length>0&&v(r.sizes[0]),r.lightBases&&r.lightBases.length>0&&j(r.lightBases[0]),r.backgroundOptions&&r.backgroundOptions.length>0&&I(r.backgroundOptions[0]),r.textOptions&&r.textOptions.length>0&&k(r.textOptions[0]),p.vF.success("Product loaded",{name:r.name,id:r.id})}catch(e){p.vF.error("Failed to fetch product",e),g(e.message)}finally{u(!1)}},W=()=>{let e=(null==x?void 0:x.price)||(null==n?void 0:n.basePrice)||0;return(null==w?void 0:w.price)&&(e+=w.price),(null==N?void 0:N.price)&&(e+=N.price),(null==S?void 0:S.price)&&(e+=S.price),e*z},Y=async()=>{if(!(()=>{let e={};return(null==n?void 0:n.sizes)&&n.sizes.length>0&&!x&&(e.size="Please select a size"),(null==n?void 0:n.requiresImage)&&(B?O||(e.finalImage="Please save your edited image before adding to cart"):e.image="Please upload an image"),G(e),0===Object.keys(e).length})())return void p.vF.warn("Form validation failed",T);_(!0),g(""),H("");try{let e,a;if(!n)throw Error("Product not loaded");if(O){let t=new window.Image;t.src=O,y(n.id.toString(),O),await new Promise(e=>{t.onload=e}),e={dataUrl:O,filename:U||"product-".concat(n.id,"-").concat(Date.now(),".png"),mimeType:"image/png",fileSize:O.length,width:t.width,height:t.height,processedAt:new Date().toISOString(),maskId:n.maskImageUrl,maskName:"Product Mask"},p.vF.order("Built custom image",{filename:e.filename,size:"".concat(e.width,"x").concat(e.height),fileSize:"".concat((e.fileSize/1024).toFixed(2),"KB")});let a=b();if(p.vF.info("Storage health check",a),!a.isHealthy){let e=(a.usedSpace/1048576).toFixed(2),t=(a.totalSpace/1048576).toFixed(2);throw p.vF.warn("Storage health check failed",a),Error("Storage almost full (".concat(e,"MB / ").concat(t,"MB used). ")+"Please clear your cart or browser cache to continue.")}}let r={sizeId:(null==x?void 0:x.id)||"default",sizeName:(null==x?void 0:x.name)||"Default Size",basePrice:(null==x?void 0:x.price)||n.basePrice},s=(()=>{let e=[];return w&&e.push({category:"lightBase",optionId:w.id,name:w.name,value:w.name,priceModifier:w.price||0}),N&&e.push({category:"background",optionId:N.id,name:N.name,value:N.name,priceModifier:N.price}),S&&e.push({category:"textOption",optionId:S.id,name:S.name,value:S.name,priceModifier:S.price}),e})(),i=F.line1||F.line2?"".concat(F.line1).concat(F.line2?"\n"+F.line2:""):void 0,l=(a=0,(null==w?void 0:w.price)&&(a+=w.price),(null==N?void 0:N.price)&&(a+=N.price),(null==S?void 0:S.price)&&(a+=S.price),a),o=W(),c={lineItemId:"line_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),productId:String(n.id),cockpit3d_id:n.cockpit3d_id||String(n.id),name:n.name,sku:n.sku,basePrice:(null==x?void 0:x.price)||n.basePrice,optionsPrice:l,totalPrice:o,quantity:z,size:r,options:s,customImage:e,customText:i?{text:i}:void 0,dateAdded:new Date().toISOString(),lastModified:new Date().toISOString()};p.vF.order("Adding item to cart",{productId:c.productId,name:c.name,quantity:c.quantity,totalPrice:c.totalPrice,hasCustomImage:!!c.customImage,hasCustomText:!!c.customText,imageSize:c.customImage?c.customImage.fileSize:0});try{await f(c),p.vF.success("Item successfully added to cart")}catch(e){throw p.vF.error("Cart add failed",e),Error("Failed to add to cart: ".concat(e.message))}H("Added ".concat(z," ").concat(n.name," to cart!")),setTimeout(()=>{P(1),C({line1:"",line2:""}),E(null),R(null),t.push("/cart")},1500)}catch(e){p.vF.error("Failed to add to cart",e),g(e.message||"Failed to add to cart")}finally{_(!1)}};if(d)return(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"inline-block w-12 h-12 border-4 border-[var(--brand-400)] border-t-transparent rounded-full animate-spin mb-4"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Loading product..."})]})});if(m&&!n)return(0,r.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,r.jsxs)("div",{className:"bg-red-900/20 border border-red-500 rounded-lg p-6 max-w-2xl mx-auto",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-red-400 mb-2",children:"Product Not Found"}),(0,r.jsx)("p",{className:"text-gray-300 mb-4",children:m}),(0,r.jsx)(o(),{href:"/products",className:"btn btn-primary px-6 py-2 rounded-lg",children:"Browse All Products"})]})});if(!n)return null;let K=n.images.find(e=>e.isMain)||n.images[0];return(0,r.jsxs)("div",{className:"min-h-screen",children:[(0,r.jsx)("nav",{className:"breadcrumbs py-4",children:(0,r.jsxs)("div",{className:"container mx-auto px-4",children:[(0,r.jsx)(o(),{href:"/",className:"hover:text-brand-400 transition-colors",children:"Home"}),(0,r.jsx)("span",{className:"mx-2 text-gray-600",children:"/"}),(0,r.jsx)(o(),{href:"/products",className:"hover:text-brand-400 transition-colors",children:"Products"}),(0,r.jsx)("span",{className:"mx-2 text-gray-600",children:"/"}),(0,r.jsx)("span",{className:"text-text-tertiary",children:n.name})]})}),(0,r.jsxs)("div",{className:"container mx-auto py-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-8",children:[(0,r.jsx)("div",{children:O?(0,r.jsxs)("div",{className:"sticky top-[var(--header-height)] z-1 mt-4",children:[(0,r.jsx)(l.default,{src:O,alt:"Customer Preview",className:"w-full max-w-xs rounded-lg border border-[var(--surface-700)]",width:1024,height:1024}),(0,r.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>D(!0),className:"btn btn-secondary px-4 py-3 rounded-md cursor-pointer",children:"Edit Image Again"}),(0,r.jsx)("button",{type:"button",onClick:()=>R(null),className:"btn btn-secondary px-4 py-3 rounded-md cursor-pointer",children:"Remove & Show Product"})]})]}):n.images&&n.images.length>1?(0,r.jsx)("div",{className:"sticky top-[var(--header-height)]",children:(0,r.jsx)(ProductGallery,{images:n.images})}):(0,r.jsx)("div",{className:"sticky top-[var(--header-height)]",children:(0,r.jsx)(l.default,{src:K.src,alt:n.name,width:1024,height:1024,className:"w-full h-auto rounded-lg"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-4",children:n.name}),(0,r.jsx)("p",{className:"text-gray-400 mb-6",children:n.description}),(0,r.jsxs)("div",{className:"text-2xl font-bold mb-6",children:["$",W().toFixed(2)]}),q&&(0,r.jsx)("div",{className:"bg-green-900/20 border border-green-500 rounded-lg p-4 mb-6",children:(0,r.jsx)("p",{className:"text-green-400",children:q})}),m&&(0,r.jsx)("div",{className:"bg-red-900/20 border border-red-500 rounded-lg p-4 mb-6",children:(0,r.jsx)("p",{className:"text-red-400",children:m})}),n.requiresImage&&(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-xl font-medium mb-2",children:"Upload Image *"}),(0,r.jsx)("input",{type:"file",accept:"image/jpeg,image/png,image/gif",onChange:e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(!a)return;if(M(a.name),a.size>5242880)return void G({...T,image:"Image must be less than 5MB"});if(!["image/jpeg","image/png","image/gif"].includes(a.type))return void G({...T,image:"Please upload JPG, PNG, or GIF"});let r=new FileReader;r.onload=e=>{var t;E(null==(t=e.target)?void 0:t.result),D(!0)},r.readAsDataURL(a)},className:"block w-full text-sm text-gray-400 border-[var(--primary)] border-1 rounded-lg   file:mr-4 file:py-2 file:px-4   file:rounded-md file:border-0   file:text-sm file:font-semibold   file:bg-[var(--primary)] file:text-white   hover:file:bg-[var(--brand-600)]   file:cursor-pointer cursor-pointer"}),T.image&&(0,r.jsx)("p",{className:"text-red-400 text-sm mt-2",children:T.image}),T.finalImage&&(0,r.jsx)("p",{className:"text-red-400 text-sm mt-2",children:T.finalImage}),(0,r.jsxs)("div",{className:"mt-4 rounded-xl border border-orange-500/30 bg-orange-500/5 px-3 py-1 text-left",children:[(0,r.jsx)("p",{className:"text-sm mt-2",children:(0,r.jsx)("strong",{children:"Image Requirements:"})}),(0,r.jsxs)("ul",{className:"list-inside list-disc font-thin text-sm p-2",children:[(0,r.jsx)("li",{children:"File type: JPG, PNG, or GIF"}),(0,r.jsx)("li",{children:"Maximum size: 5MB"}),(0,r.jsx)("li",{children:"Minimum dimensions: 500x500 pixels"}),(0,r.jsx)("li",{children:"Higher resolution recommended for best results"})]})]})]}),n.sizes&&n.sizes.length>0&&(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-xl font-medium mb-2",children:"Size *"}),(0,r.jsx)("div",{className:"space-y-2",children:n.sizes.map(e=>(0,r.jsxs)("label",{className:"crystal-radio flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:"size",value:e.id,checked:(null==x?void 0:x.id)===e.id,onChange:()=>v(e),className:"mr-3"}),(0,r.jsxs)("span",{children:[e.name," ",e.price>0&&"(+$".concat(e.price,")")]})]},e.id))}),T.size&&(0,r.jsx)("p",{className:"text-red-400 text-sm mt-2",children:T.size})]}),n.backgroundOptions&&n.backgroundOptions.length>0&&(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-xl font-medium mb-2",children:"Background"}),(0,r.jsx)("div",{className:"space-y-2",children:n.backgroundOptions.map(e=>(0,r.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:"background",value:e.id,checked:(null==N?void 0:N.id)===e.id,onChange:()=>I(e),className:"mr-3"}),(0,r.jsxs)("span",{children:[e.name," ",e.price>0&&"(+$".concat(e.price,")")]})]},e.id))})]}),n.lightBases&&n.lightBases.length>0&&(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-xl font-medium mb-2",children:"Light Base"}),(0,r.jsx)("div",{className:"space-y-2",children:n.lightBases.map(e=>(0,r.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:"lightBase",value:e.id,checked:(null==w?void 0:w.id)===e.id,onChange:()=>j(e),className:"mr-3"}),(0,r.jsxs)("span",{children:[e.name," ",e.price&&e.price>0&&"(+$".concat(e.price,")")]})]},e.id))})]}),n.textOptions&&n.textOptions.length>0&&(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Custom Text (Optional)"}),(0,r.jsx)("input",{type:"text",placeholder:"Line 1",value:F.line1,onChange:e=>C({...F,line1:e.target.value}),className:"w-full px-4 py-2 rounded-lg bg-[var(--surface-800)] border border-[var(--surface-700)] mb-2",maxLength:30}),(0,r.jsx)("input",{type:"text",placeholder:"Line 2",value:F.line2,onChange:e=>C({...F,line2:e.target.value}),className:"w-full px-4 py-2 rounded-lg bg-[var(--surface-800)] border border-[var(--surface-700)]",maxLength:30})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Quantity"}),(0,r.jsx)("input",{type:"number",min:"1",value:z,onChange:e=>P(parseInt(e.target.value)||1),className:"w-24 px-4 py-2 rounded-lg bg-[var(--surface-800)] border border-[var(--surface-700)]"})]}),(0,r.jsx)("button",{onClick:Y,disabled:L,className:"w-full btn btn-primary py-3 rounded-lg text-lg font-semibold disabled:opacity-50",children:L?"Adding to Cart...":"Add to Cart - $".concat(W().toFixed(2))})]})]}),n.requiresImage&&n.maskImageUrl&&(0,r.jsx)(h,{show:A,onHide:()=>D(!1),uploadedImage:B,maskImage:n.maskImageUrl,onSave:e=>{p.vF.info("Image saved from editor",{size:e.length}),R(e),D(!1),G(e=>{let t={...e};return delete t.image,delete t.finalImage,t})}})]})]})}a(8716),a(5267)},8716:()=>{},9723:(e,t,a)=>{"use strict";a.d(t,{vF:()=>r});let r={api:(e,t)=>{1},success:(e,t)=>{1},warn:(e,t)=>{1},error:(e,t)=>{},image:(e,t)=>{},order:(e,t)=>{1},product:(e,t)=>{1},payment:(e,t)=>{1},info:(e,t)=>{1}}}},e=>{e.O(0,[734,874,766,464,441,964,358],()=>e(e.s=1783)),_N_E=e.O()}]);